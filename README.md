# Spikes to Signals: Modeling Mouse Feedback from Neural Spiking Data

## Overview
This project analyzes 18 experimental mouse sessions stored as `.rds` files. It builds a combined dataset of trial-level behavioral outcomes and neural spiking activity, explores summary statistics and visualizations, normalizes neural activity across sessions, and trains multiple predictive models to classify feedback outcomes based on stimulus contrasts and neural features.

Project Goals / Questions
- How do neural spike counts vary across **stimulus contrast conditions** (left vs. right)?
- How does neural activity differ between **successful vs. failed feedback** trials?
- Can we predict trial feedback using **contrast features + residualized spiking activity**?
- Do non-linear models (Random Forest / SVM) outperform a baseline Logistic Regression?

## What the Script Does

1. **Load session data**
   - Reads `session1.rds` through `session18.rds` into a list.
2. **Session-level summaries**
   - Mouse ID, experiment date, number of trials, number of neurons, success/failure counts.
   - Visualizes trials per mouse.
3. **Stimulus condition visualization**
   - Scatter plot of `contrast_left` vs `contrast_right`.
4. **Neural activity exploration**
   - Computes average firing rates and spike count distributions.
   - Plots mean firing rate over time for an example session.
5. **Data integration**
   - Builds a unified, trial-level table with:
     - `mouse`, `date`, `feedback`, `contrast_left`, `contrast_right`, and `spikes` (trial spike counts).
   - Computes mean spike counts by stimuli + feedback.
6. **Normalization and de-biasing**
   - Standardizes spike counts within each mouse/date (`norm_spikes`).
   - Fits a linear model to remove session/mouse/day effects and extracts `residual_spikes`.
7. **Predictive modeling**
   - Splits data into train/test.
   - Trains and evaluates:
     - Logistic Regression
     - Random Forest
     - SVM (radial)
   - Reports accuracy on the test set.
8. **Export artifacts**
   - Saves integrated data (`integrated_data.rds`)
   - Saves “best model” (intended)
   - Generates prediction CSV for a provided test set

## Repository Structure
- `STA 141 Project.R` — Main script (data loading → EDA → integration → modeling → exports)
- `integrated_data.rds` — Saved trial-level dataset for modeling (generated by script)
- `best_model.rds` — Saved model object (generated by script)
- `test_predictions.csv` — Predictions for `test.rds` (generated if test file is present)

## Requirements
R packages used:
- `ggplot2`
- `data.table`
- `dplyr`
- `cluster`
- `caret`
- `randomForest`
- `e1071`

## Install missing packages:
```r
install.packages(c(
  "ggplot2","data.table","dplyr","cluster",
  "caret","randomForest","e1071"
))

 
  "caret","randomForest","e1071"
))
